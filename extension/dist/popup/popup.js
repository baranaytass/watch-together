(()=>{"use strict";const t=[{domain:"youtube.com",name:"YouTube",selector:"video.html5-main-video"},{domain:"vimeo.com",name:"Vimeo",selector:"video"}];class e{constructor(){this.startButton=document.getElementById("startButton"),this.statusMessage=document.getElementById("status-message"),this.initializeListeners()}initializeListeners(){this.startButton.addEventListener("click",(()=>this.handleStartClick())),this.checkCurrentTab()}async checkCurrentTab(){const[e]=await chrome.tabs.query({active:!0,currentWindow:!0});if(!e.url)return this.updateStatus("No active tab found. Please refresh the page.",!0),void(this.startButton.disabled=!0);const s=new URL(e.url);if(t.some((t=>s.hostname.includes(t.domain)))){const e=t.find((t=>s.hostname.includes(t.domain)));this.updateStatus(`Ready to watch ${e?.name} video together!`,!1),this.startButton.disabled=!1}else{const e=t.map((t=>t.name)).join(", ");this.updateStatus(`This website is not supported. Currently supported platforms: ${e}`,!0),this.startButton.disabled=!0}}async handleStartClick(){this.startButton.disabled=!0,this.updateStatus("Initializing...",!1);try{const[t]=await chrome.tabs.query({active:!0,currentWindow:!0});await chrome.tabs.sendMessage(t.id,{action:"INITIALIZE_SESSION"}),this.updateStatus("Session started!",!1),window.close()}catch(t){console.error("Error starting session:",t),this.updateStatus("Failed to start session",!0),this.startButton.disabled=!1}}updateStatus(t,e){this.statusMessage.textContent=t,this.statusMessage.className=e?"error":"success"}}document.addEventListener("DOMContentLoaded",(()=>{new e}))})();